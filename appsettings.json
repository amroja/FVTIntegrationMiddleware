{
  "Serilog": {
    "MinimumLevel": {
      "Default": "Information",
      "Override": {
        "Microsoft": "Warning",
        "System": "Warning"
      }
    }
  },
  "AllowedHosts": "*",
  "ProxyConfiguration": {
    "Routes": [
      {
        "RouteId": "external-to-internal",
        "Description": "External API calls coming into our internal system",
        "MatchPath": "/api/internal/{**catch-all}",
        "DestinationPrefix": "https://internal-api.company.com",
        "Direction": "Incoming",
        "Transformations": [
          {
            "Type": "ValidateHeader",
            "HeaderName": "X-API-Key",
            "Required": true
          },
          {
            "Type": "ModifyJsonBody",
            "JsonPath": "$.country",
            "OldValue": "US",
            "NewValue": "USA"
          },
          {
            "Type": "AddHeader",
            "HeaderName": "X-Validated-By",
            "HeaderValue": "FVT-Middleware"
          }
        ]
      },
      {
        "RouteId": "internal-to-external",
        "Description": "Internal system calling external APIs",
        "MatchPath": "/api/external/{**catch-all}",
        "DestinationPrefix": "https://external-api.partner.com",
        "Direction": "Outgoing",
        "Transformations": [
          {
            "Type": "AddHeader",
            "HeaderName": "X-Proxy",
            "HeaderValue": "FVT"
          },
          {
            "Type": "ModifyQueryParam",
            "ParamName": "version",
            "ParamValue": "v2"
          }
        ],
        "ResponseTransformations": [
          {
            "Type": "InjectMetadata",
            "JsonPath": "$",
            "Metadata": {
              "proxyModified": true,
              "processedAt": "{{timestamp}}"
            }
          }
        ]
      },
      {
        "RouteId": "payment-gateway",
        "Description": "Payment processing API",
        "MatchPath": "/api/payments/{**catch-all}",
        "DestinationPrefix": "https://payment-gateway.example.com",
        "Direction": "Outgoing",
        "Transformations": [
          {
            "Type": "AddHeader",
            "HeaderName": "Authorization",
            "HeaderValue": "Bearer {{secret:PaymentApiKey}}"
          },
          {
            "Type": "MaskSensitiveData",
            "JsonPaths": [ "$.creditCard", "$.cvv" ]
          }
        ]
      }
    ]
  },
  "ReverseProxy": {
    "Routes": {
      "internal-route": {
        "ClusterId": "internal-cluster",
        "Match": {
          "Path": "/api/internal/{**catch-all}"
        }
      },
      "external-route": {
        "ClusterId": "external-cluster",
        "Match": {
          "Path": "/api/external/{**catch-all}"
        }
      },
      "payment-route": {
        "ClusterId": "payment-cluster",
        "Match": {
          "Path": "/api/payments/{**catch-all}"
        }
      }
    },
    "Clusters": {
      "internal-cluster": {
        "Destinations": {
          "destination1": {
            "Address": "https://internal-api.company.com/"
          }
        }
      },
      "external-cluster": {
        "Destinations": {
          "destination1": {
            "Address": "https://external-api.partner.com/"
          }
        }
      },
      "payment-cluster": {
        "Destinations": {
          "destination1": {
            "Address": "https://payment-gateway.example.com/"
          }
        }
      }
    }
  }
}